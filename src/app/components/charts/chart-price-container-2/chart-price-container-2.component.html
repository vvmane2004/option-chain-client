<div class="chart-price-container-2">
  <!-- Chart Header -->
  <div class="chart-header">
    <h3>Price with TTM Squeeze</h3>
    <div class="chart-actions">
      <button class="refresh-btn" (click)="loadData()" [disabled]="loading">
        <span *ngIf="loading" class="loading-spinner"></span>
        {{ loading ? 'Loading...' : 'Refresh' }}
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="loading">
    <div class="loading-spinner"></div>
    <p>Loading underlying price data...</p>
  </div>

  <!-- Error State -->
  <div class="error-state" *ngIf="error">
    <div class="error-icon">‚ö†Ô∏è</div>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="loadData()">Retry</button>
  </div>

  <!-- No Data State -->
  <div class="no-data-state" *ngIf="!loading && !error && (!data || data.length === 0)">
    <div class="no-data-icon">üìà</div>
    <p>No underlying price data available</p>
  </div>

  <!-- Chart Canvas -->
  <div class="chart-wrapper" *ngIf="!loading && !error && data && data.length > 0">
    <canvas #chartCanvas></canvas>
  </div>

      <!-- TTM Squeeze Histogram -->
      <div class="ttm-squeeze-wrapper" *ngIf="!loading && !error && data && data.length > 0">
        <app-chart-ttm-squeeze 
          [squeezeData]="ttmSqueezeData"
          [dates]="chartDates"
          [period]="20"
          [kcMultiplier]="1.5"
          [bbMultiplier]="2.0"
          (ttmSqueezeInfoChange)="onTtmSqueezeInfoChange($event)">
        </app-chart-ttm-squeeze>
      </div>

      <!-- DMI Chart -->
      <div class="dmi-chart-wrapper" *ngIf="!loading && !error && data && data.length > 0">
        <app-chart-dmi 
          [priceData]="priceData" 
          [dates]="chartDates" 
          [length]="14"
          (dmiInfoChange)="onDmiInfoChange($event)">
        </app-chart-dmi>
      </div>

  <!-- Data Summary -->
  <div class="data-summary" *ngIf="data && data.length > 0">
    <div class="summary-item">
      <span class="label">Data Points:</span>
      <span class="value">{{ data.length }}</span>
    </div>
    <div class="summary-item">
      <span class="label">Price Range:</span>
      <span class="value">{{ getPriceRange() }}</span>
    </div>
    <div class="summary-item">
      <span class="label">Date Range:</span>
      <span class="value">{{ getDateRange() }}</span>
    </div>
    <div class="summary-item ttm-squeeze-info">
      <span class="label">TTM Squeeze (20,1.5,2.0):</span>
      <span class="value">{{ ttmSqueezeInfo }}</span>
    </div>
        <div class="summary-item demand-supply-info">
          <span class="label">Demand & Supply Zones:</span>
          <span class="value">{{ getDemandSupplyZonesInfo() }}</span>
        </div>
        <div class="summary-item dmi-info">
          <span class="label">DMI (14):</span>
          <span class="value">{{ dmiInfo }}</span>
        </div>
      </div>
    </div>

